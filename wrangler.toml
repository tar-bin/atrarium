name = "atrarium"
main = "src/index.ts"
compatibility_date = "2024-10-22"
compatibility_flags = ["nodejs_compat"]

# D1 Database Binding
# For local development, Wrangler will use a local SQLite database
[[d1_databases]]
binding = "DB"
database_name = "atrarium-db"
database_id = "local-dev-db"  # For production: Run `wrangler d1 create atrarium-db` and replace with actual ID

# KV Namespace Binding
# For local development, Wrangler will use in-memory KV
[[kv_namespaces]]
binding = "POST_CACHE"
id = "local-dev-kv"  # For production: Run `wrangler kv:namespace create POST_CACHE` and replace with actual ID
preview_id = "local-dev-kv-preview"

# Environment Variables
[vars]
ENVIRONMENT = "development"

# Cron Triggers (for post deletion sync)
[triggers]
crons = ["0 */12 * * *"]  # Every 12 hours

# Build Configuration
[build]
command = "npm run typecheck"

# Upload Rules
[[rules]]
globs = ["**/*.{ts,js,json}"]
type = "ESModule"
