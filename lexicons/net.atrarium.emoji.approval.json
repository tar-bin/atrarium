{
  "lexicon": 1,
  "id": "net.atrarium.emoji.approval",
  "defs": {
    "main": {
      "type": "record",
      "description": "Emoji approval decision by a community owner. Stored in the community owner's Personal Data Server (PDS). Approved emoji are registered in the community's emoji namespace and cached in Durable Objects for fast lookups.",
      "key": "tid",
      "record": {
        "type": "object",
        "required": ["shortcode", "emojiRef", "communityId", "status", "approver", "decidedAt"],
        "properties": {
          "shortcode": {
            "type": "string",
            "description": "Registered shortcode in community namespace (unique per community). Must match the shortcode in the referenced custom emoji.",
            "pattern": "^[a-z0-9_]+$",
            "maxLength": 32,
            "minLength": 2
          },
          "emojiRef": {
            "type": "string",
            "format": "at-uri",
            "description": "AT URI of the custom emoji record (e.g., at://did:plc:xxx/net.atrarium.emoji.custom/yyy)"
          },
          "communityId": {
            "type": "string",
            "description": "Community identifier (8-character hex). Defines the emoji namespace scope.",
            "pattern": "^[0-9a-f]{8}$",
            "maxLength": 8,
            "minLength": 8
          },
          "status": {
            "type": "string",
            "description": "Approval status: 'approved' (emoji available in community), 'rejected' (not available), 'revoked' (previously approved, now removed)",
            "enum": ["approved", "rejected", "revoked"]
          },
          "approver": {
            "type": "string",
            "format": "did",
            "description": "DID of the community owner who made the approval decision"
          },
          "decidedAt": {
            "type": "string",
            "format": "datetime",
            "description": "Timestamp when the approval decision was made (ISO 8601)"
          },
          "reason": {
            "type": "string",
            "description": "Optional reason for rejection or revocation",
            "maxLength": 500,
            "maxGraphemes": 250
          }
        }
      }
    }
  }
}
